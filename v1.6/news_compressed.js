/* Written by jcpyun */
function displaytime(){var e=new Date,t=String(e.getHours()),n=String(e.getMinutes()),o=String(e.getSeconds());1==t.length&&(t=0+t),1==n.length&&(n=0+n),1==o.length&&(o=0+o);var s=t+":"+n+":"+o;document.getElementById("displaytime").innerHTML=s}function quotes(){symbols=["EBAY","AAPL","MSFT","TSLA","GOOGL","AMZN"];for(var e="",t=0;t<symbols.length;t++){xmlhttp=new XMLHttpRequest,xmlhttp.open("GET","https://www.bloomberg.com/markets/chart/data/1D/"+symbols[t]+":US",!1),xmlhttp.send();var n=JSON.parse(xmlhttp.responseText);if(0!=n.show_1D){if(datapoints=n.data_values,datapoints=n.data_values[datapoints.length-1][1],prevclose=n.prev_close,delta=datapoints-prevclose,delta=Math.round(100*delta)/100,percent=delta/prevclose*100,percent=Math.round(100*percent)/100,percent="(%"+String(percent)+")",delta>=0){var o="green";delta=String(delta),delta="+"+delta}if(delta<0)var o="red";e+="<font color='white'>"+symbols[t]+"</font>:<font color="+o+">"+datapoints+"&nbsp&nbsp"+delta+"&nbsp"+percent+"</font>&nbsp &nbsp &nbsp"}}document.getElementById("quotes").innerHTML=e}function ModularNews(e,t){var n={cnn:"CNN","the-new-york-times":"The New York Times",bloomberg:"Bloomberg","bbc-news":"BBC","business-insider":"Business Insider","google-news":"Google News","the-economist":"The Economist","hacker-news":"Hacker News","national-geographic":"National Geographic",time:"Time"},o="8a284b7114cc49efa3f55b969b850f9a";xmlhttp=new XMLHttpRequest,xmlhttp.open("GET","https://newsapi.org/v1/articles?source="+e+"&sortBy="+t+"&apiKey="+o,!1),xmlhttp.send();for(var s=JSON.parse(xmlhttp.responseText),a=[],l=(document.createElement("div"),document.createElement("br"),""),r=0;r<s.articles.length;r++)a.push(s.articles[r].title),urllink=s.articles[r].url,l+="<div class='orfont'>-<a href=\""+urllink+'">'+s.articles[r].title+"</a><br></div>";return"<div class='compfont'>"+n[e]+"</div>"+l}function columnCreater(e,t){var n="";if(1==t){for(var n='<div class="row">',o=0;o<e.length;o++)n+='<div class="cols">'+ModularNews(e[o],"top")+"</div>";n+="</div>"}if(2==t){for(var n,o=0;o<e.length-1;o+=2)n+='<div class="row">',n+='<div class="cols">'+ModularNews(e[o],"top")+"</div>",n+='<div class="cols">'+ModularNews(e[o+1],"top")+"</div>",n+="</div>";n+="</div>"}if(420==t){for(var n,o=0;o<e.length-1;o+=2)n+='<div class="row">',n+='<div class="col-6">'+ModularNews(e[o],"top")+"</div>",n+='<div class="col-6">'+ModularNews(e[o+1],"top")+"</div>",n+="</div>";n+="</div>"}document.getElementById("modular").innerHTML=n}document.addEventListener("DOMContentLoaded",function(){displaytime(),quotes(),window.setInterval(displaytime,1e3),window.setInterval(quotes,1e3)}),chrome.storage.sync.get(null,function(e){var t=e.columnSetting,n=e.newsList;2!=t&&1!=t&&columnCreater(["bloomberg","bbc-news","google-news","the-economist"],420),1==t&&$(document).ready(function(){columnCreater(n,1);for(var e=document.getElementsByClassName("cols");e.length;)e[0].className="col-12"}),2==t&&$(document).ready(function(){columnCreater(n,2);for(var e=document.getElementsByClassName("cols");e.length;)e[0].className="col-6"})});